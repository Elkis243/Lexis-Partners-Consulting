{% load static %}
{% load i18n %}

<nav class="navbar navbar-expand-md sticky-top position-absolute w-100 bg-transparent" style="z-index: 1000">
  <div class="container mt-3 px-5">
    <div class="d-flex align-items-center justify-content-between w-100">
      <!-- Logo -->
      <div class="d-flex align-items-center">
        <a href="{% url 'index' %}" class="navbar-brand m-0 p-0 d-flex align-items-center">
          <span class="fw-bold text-gold">LEXIS</span>
          <span class="text-white ms-1">Partners Consulting</span>
        </a>
      </div>

      <!-- Menu principal (tablette et desktop) -->
      <div class="d-none d-md-flex align-items-center">
        <ul class="navbar-nav me-4">
          <li class="nav-item">
            <a class="nav-link mx-2 p-1 py-2 px-3 text-white rounded-2 {% if page == 'Accueil' %}active-link{% endif %}" href="{% url 'index' %}">
              {% trans "Accueil" %}
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link mx-2 p-1 py-2 px-3 text-white rounded-2 {% if page == 'Qui sommes-nous ?' %}active-link{% endif %}" href="{% url 'about' %}">
              {% trans "A propos" %}
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link mx-2 p-1 py-2 px-3 text-white rounded-2 {% if page == 'Nos services' %}active-link{% endif %}" href="{% url 'services' %}">
              {% trans "Nos services" %}
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link mx-2 p-1 py-2 px-3 text-white rounded-2 {% if page == 'Contact' %}active-link{% endif %}" href="{% url 'contact' %}">
              {% trans "Contactez-nous" %}
            </a>
          </li>
        </ul>

        <!-- Sélecteur de langue -->
        <form action="{% url 'set_language' %}" method="post" class="d-flex align-items-center">
          {% csrf_token %}
          {% get_current_language as LANGUAGE_CODE %}
          {% get_available_languages as LANGUAGES %}
          {% get_language_info_list for LANGUAGES as languages %}
          <div class="language-selector position-relative">
            <select name="language" onchange="this.form.submit()" class="form-select form-select-sm bg-dark border border-gold text-white rounded-pill px-3 py-1" style="min-width: 80px; font-size: 0.9rem;">
              {% for language in languages %}
                <option value="{{ language.code }}" {% if language.code == LANGUAGE_CODE %}selected{% endif %} class="bg-dark text-white">
                  {{ language.code|upper }}
                </option>
              {% endfor %}
            </select>
            <i class="bi bi-globe text-gold position-absolute" style="right: 8px; top: 50%; transform: translateY(-50%); pointer-events: none; font-size: 0.8rem;"></i>
          </div>
        </form>
      </div>

      <!-- Bouton burger pour mobile -->
      <button class="navbar-toggler d-md-none shadow-none border-0 text-white" type="button" data-bs-toggle="offcanvas"
        data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-expanded="false"
        aria-label="Toggle navigation">
        <i class="bi bi-list fs-1"></i>
      </button>
    </div>
  </div>
</nav>

<!-- Menu Offcanvas (mobile) -->
<div class="offcanvas offcanvas-start custom-offcanvas" tabindex="-1" id="offcanvasNavbar">
  <div class="offcanvas-header mt-3 px-5">
    <a href="{% url 'index' %}" class="navbar-brand m-0 p-0">
      <span class="fw-bold text-gold">LEXIS</span>
      <span class="text-white ms-1">Partners Consulting</span>
    </a>
    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>

  <div class="offcanvas-body px-5">
    <!-- Sélecteur de langue mobile -->
    <form action="{% url 'set_language' %}" method="post" class="mb-4">
      {% csrf_token %}
      {% get_current_language as LANGUAGE_CODE %}
      {% get_available_languages as LANGUAGES %}
      {% get_language_info_list for LANGUAGES as languages %}
      <div class="language-selector-mobile position-relative">
        <select name="language" onchange="this.form.submit()" class="form-select bg-dark border border-gold text-white rounded-pill px-3 py-2" style="font-size: 0.9rem;">
          {% for language in languages %}
            <option value="{{ language.code }}" {% if language.code == LANGUAGE_CODE %}selected{% endif %} class="bg-dark text-white">
              {{ language.code|upper }} - {{ language.name_local }}
            </option>
          {% endfor %}
        </select>
        <i class="bi bi-globe text-gold position-absolute" style="right: 12px; top: 50%; transform: translateY(-50%); pointer-events: none; font-size: 0.9rem;"></i>
      </div>
    </form>

    <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
      <li class="nav-item mb-3">
        <a class="nav-link mx-2 p-1 py-2 px-3 text-white rounded-2 {% if page == 'Accueil' %}active-link{% endif %}" href="{% url 'index' %}">
          {% trans "Accueil" %}
        </a>
      </li>
      <li class="nav-item mb-3">
        <a class="nav-link mx-2 p-1 py-2 px-3 text-white rounded-2 {% if page == 'Qui sommes-nous ?' %}active-link{% endif %}" href="{% url 'about' %}">
          {% trans "A propos" %}
        </a>
      </li>
      <li class="nav-item mb-3">
        <a class="nav-link mx-2 p-1 py-2 px-3 text-white rounded-2 {% if page == 'Nos services' %}active-link{% endif %}" href="{% url 'services' %}">
          {% trans "Nos services" %}
        </a>
      </li>
      <li class="nav-item mb-3">
        <a class="nav-link mx-2 p-1 py-2 px-3 text-white rounded-2 {% if page == 'Contact' %}active-link{% endif %}" href="{% url 'contact' %}">
          {% trans "Contactez-nous" %}
        </a>
      </li>
    </ul>
  </div>
</div>
